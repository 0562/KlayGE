PROJECT(DXBC2GLSL)

CMAKE_MINIMUM_REQUIRED(VERSION 2.8.6)

IF(COMMAND cmake_policy)
	CMAKE_POLICY(SET CMP0003 NEW)
ENDIF(COMMAND cmake_policy)

SET(DXBC2GLSL_MAJOR_VERSION 0)
SET(DXBC2GLSL_MINOR_VERSION 1)
SET(DXBC2GLSL_PATCH_VERSION 0)
SET(DXBC2GLSL_VERSION ${DXBC2GLSL_MAJOR_VERSION}.${DXBC2GLSL_MINOR_VERSION}.${DXBC2GLSL_PATCH_VERSION})

SET(DXBC2GLSL_PROJECT_DIR "${CMAKE_CURRENT_SOURCE_DIR}/../..")
SET(KLAYGE_ROOT_DIR "${DXBC2GLSL_PROJECT_DIR}/..")

INCLUDE(${KLAYGE_ROOT_DIR}/cmake/Common.cmake)
INCLUDE(${KLAYGE_ROOT_DIR}/cmake/Platform.cmake)
INCLUDE(${KLAYGE_ROOT_DIR}/cmake/Compiler.cmake)

SET_PROPERTY(GLOBAL PROPERTY USE_FOLDERS ON)

SET(DXBC2GLSL_OUTPUT_DIR "${DXBC2GLSL_PROJECT_DIR}/lib/${KLAYGE_PLATFORM_NAME}")
SET(KLAYGE_BIN_DIR "${KLAYGE_ROOT_DIR}/KlayGE/bin/${KLAYGE_PLATFORM_NAME}")

SET(USE_DX_SDK FALSE)
IF(MSVC)
	IF(MSVC_VERSION LESS 1699)
		SET(USE_DX_SDK TRUE)
	ELSEIF(KLAYGE_WITH_XP_TOOLSET)
		SET(USE_DX_SDK TRUE)
	ENDIF()
ELSE()
	SET(USE_DX_SDK TRUE)
ENDIF()

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
IF(USE_DX_SDK)
	INCLUDE_DIRECTORIES(${DXBC2GLSL_PROJECT_DIR}/../External/DXSDK/Include)
ENDIF()
INCLUDE_DIRECTORIES(${DXBC2GLSL_PROJECT_DIR}/../KFL/include)
INCLUDE_DIRECTORIES(${DXBC2GLSL_PROJECT_DIR}/Include)
LINK_DIRECTORIES(${Boost_LIBRARY_DIR})
LINK_DIRECTORIES(${DXBC2GLSL_PROJECT_DIR}/../KFL/lib/${KLAYGE_PLATFORM_NAME})

ADD_SUBDIRECTORY(DXBC2GLSLLib)
ADD_SUBDIRECTORY(DXBC2GLSLCmd)
ADD_SUBDIRECTORY(DXBCDisasm)
