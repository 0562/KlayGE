SET(VORBIS_MAJOR_VERSION 1)
SET(VORBIS_MINOR_VERSION 3)
SET(VORBIS_PATCH_VERSION 6)
SET(VORBIS_VERSION ${VORBIS_MAJOR_VERSION}.${VORBIS_MINOR_VERSION}.${VORBIS_PATCH_VERSION})

SET(VORBIS_PROJECT_DIR "${CMAKE_CURRENT_SOURCE_DIR}/../../../libvorbis")
SET(VORBIS_OUTPUT_DIR "${EXTERNAL_PROJECT_DIR}/lib/libvorbis/${KLAYGE_PLATFORM_NAME}")
SET(REL_PATH "External/Downloads/libvorbis-${VORBIS_VERSION}.patched.7z")
SET(PACKAGE_FILE_ID "DC3F8C6D4531895676BC30FA72FFE774E79A4A37")

DOWNLOAD_PACKAGE("libvorbis" ${REL_PATH} ${PACKAGE_FILE_ID})

SET(BUILD_SHARED_LIBS OFF)
SET(BUILD_FRAMEWORK OFF)
SET(OGG_ROOT ${VORBIS_PROJECT_DIR}/../libogg)
SET(OGG_LIBRARIES ${EXTERNAL_PROJECT_DIR}/lib/libogg/${KLAYGE_PLATFORM_NAME}/ogg_static${KLAYGE_OUTPUT_SUFFIX})
INCLUDE_DIRECTORIES(${OGG_ROOT}/../Build/${KLAYGE_BUILD_FOLDER}/libogg/ogg/include)
IF(KLAYGE_PLATFORM_WINDOWS_STORE)
	ADD_DEFINITIONS(-D_CRT_SECURE_NO_WARNINGS)
ENDIF()

ADD_SUBDIRECTORY(${VORBIS_PROJECT_DIR} "${CMAKE_CURRENT_BINARY_DIR}/vorbis")

SET_TARGET_PROPERTIES(vorbis PROPERTIES
	ARCHIVE_OUTPUT_DIRECTORY ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${VORBIS_OUTPUT_DIR}
	PROJECT_LABEL vorbis
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME vorbis_static${KLAYGE_OUTPUT_SUFFIX}
)
SET_TARGET_PROPERTIES(vorbisfile PROPERTIES
	ARCHIVE_OUTPUT_DIRECTORY ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${VORBIS_OUTPUT_DIR}
	ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL ${VORBIS_OUTPUT_DIR}
	PROJECT_LABEL vorbisfile
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME vorbisfile_static${KLAYGE_OUTPUT_SUFFIX}
)

foreach(target
	"vorbis" "vorbisfile" "vorbisenc")
	set_target_properties(${target} PROPERTIES FOLDER "${EXTERNAL_VS_FOLDER_PREFIX}/libvorbis")
endforeach()
