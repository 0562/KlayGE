<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>KlayGE Readme</title>
</head>
<body>
<h1>粘土游戏引擎(KlayGE) 3.11.0 Readme</h1>
<p>龚敏敏<br />
	Homepage: <a href="http://www.klayge.org" target="_blank">http://www.klayge.org</a><br />
	E-Mail:	  <a href="mailto:webmaster@klayge.org">webmaster@klayge.org</a><br />
	QQ:       33611210</p>
<p>欢迎使用粘土游戏引擎 3.11.0<br />
	压缩包中包含的组件：KlayGE头文件，源代码，构建工程文件和文档。</p>
<p>KlayGE是一个开放源代码的，跨平台的，基于插件结构的游戏引擎。本引擎的设计目的是用最先进的技术武装引擎，它所提供框架使游戏的开发、测试、移植得到简化。KlayGE的目标平台是引擎发布当年的出现的最高端硬件到上一年出现的最低端硬件。</p>
<h2><a id="menu">目录</a></h2>
<ul>
	<li><a href="#license">协议</a></li>
	<li><a href="#installation">安装</a></li>
	<li><a href="#third_part">第三方库和工具</a></li>
	<li><a href="#history">发展历程</a></li>
	<li><a href="#structure">目录结构</a></li>
	<li><a href="#compiler">经过测试的编译器</a></li>
</ul>
<hr />
<h2><a id="license">协议</a></h2>
<p>KlayGE按照GPL 2.0协议发布。这意味着所有人都可以用它，而且可以访问到它全部的源代码，但必须保证用到KlayGE的项目也必须按照GPL 2.0协议进行发布。GPL 2.0协议的全文请查看<a href="gplv2.txt">gplv2.txt</a>。 </p>
<p>开放源代码是一种很强大的开发方式，它鼓励散布、合作开发和用户的自由。开放源代码软件的源代码是100%可见的，不会暗藏流氓软件，间谍软件和病毒。</p>
<p><a href="#menu">^返回目录</a></p>
<hr />
<h2><a id="installation">安装</a></h2>
<p>从KlayGE 3.10.0开始，工程文件里都设置好了include和lib路径，解压后打开Build目录下的相应工程文件就可以直接编译KlayGE本身。如果需要使用本引擎开发自己的程序，就需要：</p>
<ol>
	<li>执行KlayGE目录下的env_vars.py。该脚本设置了KLAYGE_HOME环境变量，并把bin目录添加到系统PATH环境变量中。如果没有安装pywin32，就可能需要手工修改环境变量，或重启。</li>
	<li>设置路径。这里拿Visual Studio 2008举例，其他环境请参考它们的帮助文件。
		<ol>
			<li>打开“Tools”-&gt;“Options”-&gt;“Projects and Solutions”-&gt;&quot;VC++ Directories&quot;，在“Show directories for:”下拉框中选择“Include files”，在下面添加$(KLAYGE_HOME)\Core\Include和$(KLAYGE_HOME)\Plugins\Include。</li>
			<li>在“Show directories for:”下拉框中选择&quot;Library files&quot;，在下面添加$(KLAYGE_HOME)\lib\Win32（如果要用x64的版本，就把Win32换成x64）。</li>
			<li>点“确定”按钮，建议关闭VS 2008 IDE以保存设置。</li>
		</ol>
	</li>
</ol>
<h4>MinGW用户请注意</h4>
<p>由于新版本Windows SDK，DirectX SDK和MinGW存在一些不兼容，在默认情况下编译DSound插件的时候，编译器会报告找不到sal.h。这时候需要把VC的sal.h拷到MinGW/include下。然后打开MinGW/lib/gcc/mingw32/4.4.1/include/stddef.h，找到"#define NULL __null"，改成"#define NULL 0"。因为sal.h会把__null定义成别的东西。</p>
<p><a href="#menu">^返回目录</a></p>
<hr />
<h2><a id="third_part">第三方库和工具</a></h2>
<p>在编译KlayGE的之前，需要先安装下列第三方库和工具。</p>
<h4>Core需要：</h4>
<ul>
	<li><a href="http://www.python.org" target="_blank">Python 2.6或3.1</a>。Debug版本的pythonxx_d.dll需要从Python的源代码自行编译。</li>
	<li><a href="http://www.boost.org" target="_blank">Boost 1.44.0</a>。推荐的编译命令行请参考<a href="http://www.klayge.org/html/faq_chs.html">FAQ</a>。</li>
	<li><a href="http://www.tortall.net/projects/yasm/" target="_blank">Yasm 1.1.0</a>。</li>
	<li><a href="http://rapidxml.sourceforge.net/" target="_blank">RapidXml 1.13</a>。</li>
</ul>
<h4>D3D9 Rendering System，D3D11 Rendering System和DSound Audio System需要：</h4>
<ul>
	<li><a href="http://msdn.microsoft.com/directx" target="_blank">DirectX SDK June 2010</a>。</li>
</ul>
<h4>DShow Show System需要：</h4>
<ul>
	<li>Visual Studio 2010附带的Microsoft Windows SDK 7.0A，或者Visual Studio 2008附带的Microsoft Windows SDK 6.0A，或者<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=484269e2-3b89-47e3-8eb7-1f2be6d7123a&amp;displaylang=en" target="_blank">Windows(R) Server 2003 R2 Platform SDK</a>。</li>
</ul>
<h4>OggVorbis Audio Datasource需要：</h4>
<ul>
	<li><a href="http://xiph.org/downloads/" target="_blank">libogg 1.2.0</a>和<a href="http://xiph.org/downloads/" target="_blank">libvorbis 1.3.1</a>，需要把它们编译成static库。</li>
</ul>
<h4>OpenAL Audio System需要：</h4>
<ul>
	<li><a href="http://www.openal.org/downloads.html" target="_blank">OpenAL SDK 1.1</a>。</li>
</ul>
<h4>OpenGL Rendering System需要：</h4>
<ul>
	<li><a href="http://developer.nvidia.com/object/cg_toolkit.html" target="_blank">NVIDIA Cg 3.0</a>。</li>
</ul>
<h4>OpenGL ES 2 Rendering System需要：</h4>
<ul>
	<li><a href="http://developer.amd.com/gpu/opengl/Pages/default.aspx" target="_blank">AMD OpenGL ES Emulator 1.4</a>，或者<a href="http://www.malideveloper.com/tools/software-development/opengl-es-20-emulator.php" target="_blank">ARM Mali OpenGL ES 2.0 Emulator v1.2 Beta</a></li>
</ul>
<h4>KFontGen工具需要：</h4>
<ul>
	<li><a href="http://freetype.sourceforge.net" target="_blank">FreeType 2.4.2</a>，编译它的LIB Debug和LIB Release两个solution configuration。</li>
</ul>
<h3>注意事项</h3>
<p>第一次编译KlayGE之前需要先执行env_vars.py来设置环境变量。</p>
<p>由于KlayGE在VC下使用的运行库是多线程的DLL，所以需要把<strong>所有</strong>连接到exe的lib的运行库改为多线程DLL（Project-&gt;Properties-&gt;Configuration Properties-&gt;C/C++-&gt;Code Generation-&gt;Runtime Library，选择Multi-threaded Debug DLL/Multi-threaded DLL）。</p>
<p>另外，用VC8和VC9编译Release版的Boost需要定义_SECURE_SCL=0宏，方法之一是在bjam的命令行中加上define=_SECURE_SCL=0。</p>
<p><a href="#menu">^返回目录</a></p>
<hr />
<h2><a id="history">发展历程</a></h2>
<p><strong>3.11.0</strong><br />
	<strong>支持OpenGL 4.1</strong><br />
	去掉了D3D10插件<br />
	增强Post Processor脚本<br />
	水体渲染的质量和速度都有所提高</p>
<p><strong>3.10.0 (2010.6.27)</strong><br />
	<strong>支持OpenGL ES 2.0和OpenGL 4.0</strong><br />
	<strong>支持立体显示</strong><br />
	在高端显卡上Deferred Shading速度提高120%<br />
	支持Compute Shader<br />
	字体渲染速度提高50%<br />
	字体生成工具速度提高3倍<br />
	增强了场景管理<br />
	增强的Post processing<br />
	支持Sub-Surface Scattering<br />
	支持PN Triangles</p>
<p><strong>3.9.0 (2009.12.19)</strong><br />
	增加了TrackballCameraController<br />
	增加了Model Viewer和Particle Editor<br />
	UI dialog改进<br />
	直接读取uiml，fxml和meshml<br />
	Cg载入后编译成GLSL使用<br />
	支持Motion blur<br />
	支持DX10 DDS的读写<br />
	支持Stream output<br />
	更快的Deferred Shading<br />
	加入LZMA的编解码</p>
<p><strong>3.8.0 (2009.3.1) </strong><br />
	<strong>支持DX10，DX11和OpenGL 3.0</strong><br />
	改成DLL的形式<br />
	增加了描述UI的UIML文件格式和编译器<br />
	增加了ElementAccessHint和ElementInitData<br />
	支持硬件depth texture<br />
	支持BC4/BC5纹理压缩<br />
	去掉了归一化cubemap生成器<br />
	多线程资源载入<br />
	支持Procedural Texture</p>
<p><strong>3.7.0 (2008.7.17)</strong><br />
	改进了Clear<br />
	增加了Depth Peeling例子<br />
	加速了Octree<br />
	无死角的FirstPersonCameraController<br />
	新的基于distance的字体格式<br />
	支持Visual Studio 2008<br />
	支持lock-free atomic操作<br />
	增加了CPUInfo<br />
	增加了Summed-Area Table Postprocess<br />
	实验性支持Linux<br />
	性能提升5%-10%</p>
<p><strong>3.6.0 (2007.7.30)</strong><br />
	兼容Vista 32/64<br />
	使用pbo加速纹理填充<br />
	改用7z作为打包格式<br />
	加强了3DS Max插件<br />
	RenderEffect增加了Clone方法<br />
	去掉了RenderTarget和RenderWindow<br />
	去掉了Triangle fan的拓扑方式<br />
	增加了UI系统<br />
	增加了Depth of field例子<br />
	去掉了对Wav的支持<br />
	启用了新的thread和thread_pool</p>
<p><strong>3.5.0 (2007.3.9)</strong><br />
	支持Alpha to coverage<br />
	改用基于xml的特效格式<br />
	全新的特效系统，支持所有的状态缓存<br />
	增加了RenderStateObject和ShaderObject<br />
	支持x64系统<br />
	OpenGL插件可以检测Shader Model 4<br />
	增加了基于GPU的粒子系统<br />
	增加了aligned_allocator<br />
	修正了thread_pool死锁的bug（感谢Roy报告此bug）<br />
	支持NVPerfHUD<br />
	增加了有符号元素格式<br />
	不再提供VS2003的工程文件</p>
<p><strong>3.4.0 (2006.9.22)</strong><br />
	导出插件支持骨骼的导出<br />
	支持normal map的压缩<br />
	支持HDR纹理的压缩<br />
	加入了粒子系统<br />
	重写的播放引擎，现在通过图形引擎播放视频<br />
	重写了height map地形生成器<br />
	增加了HDRPostProcess</p>
<p><strong>3.3.0 (2006.6.30)</strong><br />
	Font支持渲染到3D位置<br />
	统一了渲染引擎的状态设置<br />
	OpenGL插件要求硬件支持OpenGL 2.0和FBO<br />
	增加了FrameBuffer和RenderView的结构<br />
	使用以Technique为单位的渲染<br />
	支持渲染到3D Texture的一个片<br />
	增加了多种纹理格式<br />
	统一了元素格式的使用<br />
	DistanceMap生成器支持直接对Volume的计算<br />
	增加了PostProcess</p>
<p><strong>3.2.0 (2006.5.15)</strong><br />
	增加了高精度计时器<br />
	完整地支持骨骼动画<br />
	渲染部分的结构有了较大的调整<br />
	把IndexStream和VertexStream合并成GraphicsBuffer<br />
	增加了RenderLayout<br />
	支持sRGB纹理<br />
	支持ATI的instancing方法<br />
	增加了与平台无关的线程池</p>
<p><strong>3.1.0 (2005.11.27)</strong><br />
	增加了SceneObject<br />
	简化了Instancing的使用<br />
	支持Visual Studio 2005<br />
	分离了实例和几何顶点流</p>
<p><strong>3.0.0 (2005.10.26)</strong><br />
	去掉了固定流水线<br />
	增加了Occlusion Query<br />
	增加了Point sprite<br />
	支持Instancing<br />
	支持Vertex Texture<br />
	增强了KMesh和3dsmax导出插件<br />
	优化了RenderEffect<br />
	InputEngine改为使用Event形式处理消息<br />
	支持全场景的多遍渲染<br />
	支持顶点流的合并和拼接<br />
	增加了RenderablePlane</p>
<p><strong>2.8.0 (2005.8.14)</strong><br />
	增加了RenderDeviceCaps<br />
	增加了OpenGL兼容性检测工具<br />
	增加了Sampler<br />
	重写了RenderEffect<br />
	只支持OpenGL 1.5及以上<br />
	简化了RenderEngine<br />
	DInputDevice改为多继承结构<br />
	增加了RenderToVertexStream</p>
<p><strong>2.7.1 (2005.7.15)</strong><br />
	美化了字体显示效果<br />
	LoadKMesh可以使用自定义类<br />
	增加了RenderableHelper基类<br />
	RenderEngine::ViewMatrix和ProjectionMatrix改为const</p>
<p><strong>2.7.0 (2005.7.2)</strong><br />
	改成GPL协议<br />
	增加了KMesh<br />
	去掉了RenderEngine::TextureCoordSet<br />
	AddressingMode, Filtering和Anisotropy从RenderEngine移到Texture中<br />
	Texture增加了MaxMipLevel和MipMapLodBias<br />
	App3D增加了Quit<br />
	支持OpenGL 1.5</p>
<p><strong>2.6.0 (2005.6.2)</strong><br />
	修正了SceneManager类CanBeCulled的bug<br />
	增加了half类型<br />
	D3D9Texture增加了对surface的检查<br />
	增加了RenderableSkyBox<br />
	支持HDR</p>
<p><strong>2.5.0 (2005.5.2)</strong><br />
	增加了3DSMax导出插件<br />
	可以同时使用多个输入动作表<br />
	MathLib改为使用返回值返回结果<br />
	改进了CameraController<br />
	增加了RenderableHelper<br />
	视锥裁减改为使用LUT实现</p>
<p><strong>2.4.0 (2005.3.28)</strong><br />
	支持纹理压缩<br />
	增加了D3D9Resource<br />
	支持DDS格式的载入和保存<br />
	八叉树改为线性实现<br />
	支持深度纹理</p>
<p><strong>2.3.0 (2005.3.2)</strong><br />
	使用FreeType实现Font<br />
	修正了几个内存泄漏<br />
	增加了对浮点纹理的支持<br />
	增加了CopyToMemory<br />
	增加了视锥裁减插件<br />
	D3D9插件增加了OnLostDevice和OnResetDevice</p>
<p><strong>2.2.0 (2004.11.20)</strong><br />
	修正了DSound插件的音量问题<br />
	去掉了ManagerBase、FileSystem、Crc32、alloc、Timer、Random<br />
	使用boost 1.32.0<br />
	增加了Trace</p>
<p><strong>2.1.3 (2004.10.19)</strong><br />
	增加了以boost::tuple为参数的ScriptEngine::Call<br />
	修正了一些关于STL的问题<br />
	修正了Pkt的CRC错误<br />
	去掉了MemoryLib</p>
<p><strong>2.1.2 (2004.9.5)</strong><br />
	增加了BoneMesh<br />
	增加了RenderEffectParameter<br />
	支持DX 9.0c SDK<br />
	修正了DiskFile::Seek的Bug<br />
	把const T&amp;改为更规则的T const &amp;<br />
	InputEngine改用Bridge实现</p>
<p><strong>2.1.1 (2004.5.25)</strong><br />
	大量使用boost<br />
	数学库都采用泛型实现<br />
	增加了Parallax的Demo<br />
	增加了ResLocator</p>
<p><strong>2.1.0 (2004.4.20)</strong><br />
	增强了OpenGL<br />
	去掉了汇编代码<br />
	直接支持单独的Shader<br />
	简化了打包文件目录表的表示法</p>
<p><strong>2.0.5 (2004.4.13)</strong><br />
	增强了OpenGL<br />
	修正了WindowMovedOrResized的bug<br />
	MemFile改用stringstream实现<br />
	提高了代码安全性</p>
<p><strong>2.0.4 (2004.4.7)</strong><br />
	修正了OALMusicBuffer无法loop的bug<br />
	DSMusicBuffer改用timeSetEvent实现<br />
	改进了VertexBuffer<br />
	Audio部分增加了NullObject<br />
	增加了Demo</p>
<p><strong>2.0.3 (2004.3.12)</strong><br />
	简化了VertexBuffer<br />
	去掉了软件顶点混合</p>
<p><strong>2.0.2 (2003.12.28)</strong><br />
	改进了渲染队列<br />
	使用Python做脚本语言<br />
	DiskFile改为用标准C++流实现</p>
<p><strong>2.0.1 (2003.10.17)</strong><br />
	去掉了DX8的支持 <br />
	增加了一些工具</p>
<p><strong>2.0.0 (2003.10.1)</strong><br />
	正式版发布</p>
<p><strong>2.0.0 Beta (2003.9.5)</strong><br />
	初次发布<br />
</p>
<p><a href="#menu">^返回目录</a></p>
<hr />
<h2><a id="structure">目录结构</a></h2>
<p>下面是关于完整的KlayGE目录的主要描述。</p>
<pre>
\bin
	存放编译后的DLL和EXE

\Build
	工程文件

\Core
	内核文件

	\Include
		内核头文件

	\Src
		内核源文件

		\Audio
			音频引擎内核的源文件
		\Input
			输入引擎内核的源文件
		\Kernel
			核心源文件
		\Net
			网络引擎的源文件
		\Pack
			文件打包系统的源文件
		\Render
			渲染系统内核的源文件
		\Scene
			场景管理器内核的源文件
		\Script
			脚本引擎的源文件
		\Show
			播放引擎内核的源文件

\Doc
	文档

\Exporters
	\3DSMax
		\MeshML
			3ds max的导出插件

\media
	资源文件
	
	\Fonts
		字体文件
	\Models
		模型文件
	\RenderFX
		渲染特效脚本
	\Textures
		纹理文件

\Plugins
	插件文件

	\Include
		插件头文件

	\Src
		插件源代码

		\Audio
			音频引擎插件的源文件
		\AudioDataSource
			音频数据源插件的源文件
		\Input
			输入引擎插件的源文件
		\Render
			渲染系统插件的源文件
		\Scene
			场景管理器插件的源文件
		\Show
			播放引擎插件的源文件
		\Terrain
			地形插件的源文件

\Samples
	例子

\Tools
	工具文件

	\Bin
		编译生成的工具文件
	\DistanceMapCreator
		从height map建立distance map的工具
	\GLCompatibility
		OpenGL兼容性测试工具
	\HDRCompressor
		HDR纹理压缩器
	\KFontGen
		字库转换工具
	\NormalMapCompressor
		Normal map压缩器
	\NormalMapGen
		从height map建立normal map的工具

\lib
	存放编译后的静态连接库

</pre>
<p><a href="#menu">^返回目录</a></p>
<hr />
<h2><a id="compiler">经过测试的编译器</a></h2>
<p>下列编译器是经过测试的：</p>
<ul>
	<li>Windows平台上的Microsoft Visual C++ 9.0（Visual Studio 2008 SP1），Microsoft Visual C++ 10.0（Visual Studio 2010）。</li>
	<li>Windows平台上的MinGW GCC 4.4，4.5。</li>
	<li>Linux平台上的GNU GCC 4.4。</li>
</ul>
<p>还有一些编译器应该也支持，但没有经过测试：</p>
<ul>
	<li>Windows平台上的Microsoft Visual C++ 7.1和8.0（Visual Studio .NET 2003和2005）。</li>
	<li>Windows平台上的Intel C++ 10及以上。</li>
	<li>Linux平台上的Intel C++ 9及以上。</li>
</ul>
<p><a href="#menu">^返回目录</a></p>
<hr />
<p>最后更新：2010-6-10</p>
</body>
</html>
