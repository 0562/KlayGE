<?xml version='1.0'?>

<effect>
	<parameter type="rw_byte_address_buffer" name="ras_order_buff"/>

	<shader version="5">
		<![CDATA[
void RasterizationOrderVS(float2 pos : POSITION,
			out float4 oPos : SV_Position)
{
	oPos = float4(pos, 0.5f, 1);
}

[earlydepthstencil]
float4 RasterizationOrderPS() : SV_Target
{
	uint old_value;
	ras_order_buff.InterlockedAdd(0, 1, old_value);
	return float4((uint3(old_value >> uint3(0, 8, 16)) & 0xFF) / 255.0f, 1);
}
		]]>
	</shader>

	<technique name="RasterizationOrder">
		<pass name="p0">
			<state name="depth_enable" value="false"/>
			<state name="depth_write_mask" value="false"/>
			
			<state name="vertex_shader" value="RasterizationOrderVS()"/>
			<state name="pixel_shader" value="RasterizationOrderPS()"/>
		</pass>
	</technique>
</effect>
