SET(SOURCE_FILES 
	${KLAYGE_PROJECT_DIR}/Tools/src/MtlEditor/MtlEditorCoreWrapper/AssemblyInfo.cpp
	${KLAYGE_PROJECT_DIR}/Tools/src/MtlEditor/MtlEditorCoreWrapper/MtlEditorCoreWrapper.cpp
)

SET(HEADER_FILES 
	${KLAYGE_PROJECT_DIR}/Tools/src/MtlEditor/MtlEditorCoreWrapper/MtlEditorCoreWrapper.hpp
)

SOURCE_GROUP("Source Files" FILES ${SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${HEADER_FILES})

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/include)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/Core/Include)
LINK_DIRECTORIES(${Boost_LIBRARY_DIR})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../KFL/lib/${KLAYGE_PLATFORM_NAME})
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/lib/${KLAYGE_PLATFORM_NAME})
LINK_DIRECTORIES(${MTL_EDITOR_CORE_LIB_OUTPUT_DIR})

STRING(REPLACE "/EHsc" "/EHa" CMAKE_CXX_FLAGS ${CMAKE_CXX_FLAGS})
STRING(REPLACE "/RTC1" "" CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG})
IF(MSVC_VERSION GREATER 1600)
	STRING(REPLACE "/Qpar" "" CMAKE_CXX_FLAGS_RELEASE ${CMAKE_CXX_FLAGS_RELEASE})
	STRING(REPLACE "/Qpar" "" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
	STRING(REPLACE "/Qpar" "" CMAKE_CXX_FLAGS_MINSIZEREL ${CMAKE_CXX_FLAGS_MINSIZEREL})
	STRING(REPLACE "/GR-" "/GR" CMAKE_CXX_FLAGS_RELEASE ${CMAKE_CXX_FLAGS_RELEASE})
	STRING(REPLACE "/GR-" "/GR" CMAKE_CXX_FLAGS_RELWITHDEBINFO ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
	STRING(REPLACE "/GR-" "/GR" CMAKE_CXX_FLAGS_MINSIZEREL ${CMAKE_CXX_FLAGS_MINSIZEREL})
ENDIF()
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /clr")
SET(CMAKE_SHARED_LINKER_FLAGS "/WX:NO")
ADD_LIBRARY(MtlEditorCoreWrapper SHARED ${SOURCE_FILES} ${HEADER_FILES})

SET_TARGET_PROPERTIES(MtlEditorCoreWrapper PROPERTIES
	PROJECT_LABEL MtlEditorCoreWrapper
	DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX}
	OUTPUT_NAME MtlEditorCoreWrapper
	VS_DOTNET_TARGET_FRAMEWORK_VERSION "v4.5"
	VS_DOTNET_REFERENCES "System;System.Windows;PresentationCore"
)
ADD_DEPENDENCIES(MtlEditorCoreWrapper MtlEditorCore)

TARGET_LINK_LIBRARIES(MtlEditorCoreWrapper
	debug MtlEditorCore_d optimized MtlEditorCore)

ADD_POST_BUILD(MtlEditorCoreWrapper "")

INSTALL(TARGETS MtlEditorCoreWrapper
	RUNTIME DESTINATION ${KLAYGE_BIN_DIR}
	LIBRARY DESTINATION ${KLAYGE_BIN_DIR}
	ARCHIVE DESTINATION ${MTL_EDITOR_CORE_LIB_OUTPUT_DIR}
)

SET_TARGET_PROPERTIES(MtlEditorCoreWrapper PROPERTIES FOLDER "MtlEditor")
