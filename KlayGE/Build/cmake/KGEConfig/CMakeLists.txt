SET(EXE_NAME KGEConfig)

SET(KGECONFIG_SOURCE_FILES
	${KLAYGE_PROJECT_DIR}/Core/Src/KGEConfig/KGEConfig.cpp
)

SET(KGECONFIG_HEADER_FILES
	${KLAYGE_PROJECT_DIR}/Core/Src/KGEConfig/resource.h
)

SET(KGECONFIG_RESOURCE_FILES
	${KLAYGE_PROJECT_DIR}/Core/Src/KGEConfig/KGEConfig.rc
	${KLAYGE_PROJECT_DIR}/klayge_logo.ico
)

SOURCE_GROUP("Source Files" FILES ${KGECONFIG_SOURCE_FILES})
SOURCE_GROUP("Header Files" FILES ${KGECONFIG_HEADER_FILES})
SOURCE_GROUP("Resource Files" FILES ${KGECONFIG_RESOURCE_FILES})

INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/boost)
INCLUDE_DIRECTORIES(${KLAYGE_PROJECT_DIR}/Core/Include)
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/../External/boost/lib_${KLAYGE_COMPILER_NAME}${KLAYGE_COMPILER_VERSION}_${KLAYGE_ARCH_NAME}/lib)
LINK_DIRECTORIES(${KLAYGE_PROJECT_DIR}/lib/${KLAYGE_PLATFORM_NAME})

ADD_EXECUTABLE(${EXE_NAME} WIN32
	${KGECONFIG_SOURCE_FILES} ${KGECONFIG_HEADER_FILES} ${KGECONFIG_RESOURCE_FILES}
)
ADD_DEPENDENCIES(${EXE_NAME} ${KLAYGE_CORELIB_NAME})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES PROJECT_LABEL "${EXE_NAME}")
SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES DEBUG_POSTFIX "${CMAKE_DEBUG_POSTFIX}")
SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES OUTPUT_NAME "${EXE_NAME}${KLAYGE_NAME_POSTFIX}")

IF(MSVC)
	SET(EXTRA_LINKED_LIBRARIES "")
ELSE()
	SET(EXTRA_LINKED_LIBRARIES boost_system)
ENDIF()

TARGET_LINK_LIBRARIES(${EXE_NAME} ${EXTRA_LINKED_LIBRARIES})


GET_PROPERTY(OUT_LOCATION_DEBUG TARGET ${EXE_NAME} PROPERTY LOCATION_DEBUG)
ADD_CUSTOM_COMMAND(TARGET ${EXE_NAME}
	POST_BUILD
	COMMAND ${CMAKE_COMMAND} -E copy ${OUT_LOCATION_DEBUG} ${KLAYGE_BIN_DIR})

GET_PROPERTY(OUT_LOCATION_RELEASE TARGET ${EXE_NAME} PROPERTY LOCATION_RELEASE)
ADD_CUSTOM_COMMAND(TARGET ${EXE_NAME}
	POST_BUILD
	COMMAND ${CMAKE_COMMAND} -E copy ${OUT_LOCATION_RELEASE} ${KLAYGE_BIN_DIR})


INSTALL(TARGETS ${EXE_NAME}
    RUNTIME DESTINATION ${KLAYGE_BIN_DIR}
    LIBRARY DESTINATION ${KLAYGE_BIN_DIR}
    ARCHIVE DESTINATION ${KLAYGE_OUTPUT_DIR}
)

KLAYGE_CREATE_VCPROJ_USERFILE(${EXE_NAME})

SET_TARGET_PROPERTIES(${EXE_NAME} PROPERTIES FOLDER "KGEConfig")
